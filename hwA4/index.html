<!DOCTYPE html>

<html>
 <head>
  <meta charset="utf-8" />
  <title>HTML5</title>

  <style>

  </style>
 </head>

 <body>
  <p>Задание A4</p>
  <script>
    //рекурсивная функция. Побуквенно проверяет символы. 
    //Если один из символов пробел или знак препинания -> вызываем функцию, но передаем ей уже следующий после пробела/знака препинания символ
    //Если буквы совпадают - проверяем следующие
    //Сравниваются буквы с начала и с конца
    //Условие успешного окончания - проверка всех букв успешна и индекс символа с левого конца больше индекса символа с правого конца
    const isEqual = (str, i, j) => {
        if (i >= j) {
            return true;
        }
        if (/[ьъ\s\.\,\-]/.test(str[i])) {
            i += 1;
            return isEqual(str, i, j);
        };
        if (/[ьъ\s\.\,\-]/.test(str[j])) {
            j -= 1;
            return isEqual(str, i, j);
        };
        if (str[i].toLowerCase() === str[j].toLowerCase() || 
            (/[её]/.test(str[i].toLowerCase()) === true &&
             /[её]/.test(str[j].toLowerCase()) === true)) {
                
                i += 1;
                j -= 1;
                return isEqual(str, i, j);
            }
            else {
                return false;
            }
    }

    const userString = prompt('Введите строку', '');
    alert(`
    Ваша строка: ${userString}
    Является палиндромом: ${isEqual(userString, 0, userString.length - 1)}
    `);


    //взял блок проверки из задания А3. функция та же, поэтому просто переписал здесь ее значение, чтоб она вызывала функцию проверки из этого задания
    const palindromCheck = (str) => {
        return isEqual(str, 0, str.length - 1);
    }

    console.log('Проверка 1. Игнорирование пробелов и регистров. Фраза: \'! Ежу хуже !\'' + palindromCheck(' Ежу хуже '));
    console.log('Проверка 2. Игнорирование мягких, твердых знаков, а также знаков препинания.. Фраза: \'!Муза, ранясь шилом опыта, ты помолишься на разум!\'' + palindromCheck('Муза, ранясь шилом опыта, ты помолишься на разум'));
    console.log('Проверка 3. Игнорирование разницы  между е и ё. Фраза: \'!Ёжу хуже!\'' + palindromCheck('Ёжу хуже'));
    console.log('Проверка 4. Фраза: \'!Я - дядя ежу. Уже я дядя...!\'' + palindromCheck('Я - дядя ежу. Уже я дядя...'));
    console.log('Проверка 5. Проверка на полную несуразицу. Фраза: \'!абфьтыдфлвиорфыол!\'' + palindromCheck('абфьтыдфлвиорфыол'));

  </script>
 </body>

</html>